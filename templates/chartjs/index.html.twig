{% extends 'base.html.twig' %}

{% block title %}Chiffre d'Affaires{% endblock %}

{% block body %}

<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
    .total-wrapper { background-color: #426950; padding: 20px; text-align: center; }
    .total-text { font-size: 24px; font-weight: #f5f5f5; }
    .total-wrapper { background-color: #426950; padding: 20px; text-align: center; }
    .total-text { font-size: 24px; font-weight: #f5f5f5; }
</style>

{% include "header/_header.html.twig" %}

<div class="example-wrapper">
    <div class="total-wrapper">
        <p class="total-text">Somme totale : {{ resultss }} €</p>
    </div>
    <ul>
        {% for result in results %}
            <li>Date : {{ result['date_realisation']|date('Y-m-d') }}, chiffre d'affaire : {{ result['total'] }} €</li>
        {% endfor %}
    </ul>

    <div class="canva">
        <canvas id="myChart"></canvas>
    </div>
    {% if results is not empty %}
        <p>Chiffre d'affaires pour la période sélectionnée :</p>
        <ul>
            {% for result in results %}
                <li>Date : {{ result['date_realisation']|date('Y-m-d') }}, chiffre d'affaires : {{ result['total'] }} €</li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Aucun chiffre d'affaires calculé pour les dates sélectionnées.</p>
    {% endif %}
</div>
<<<<<<< HEAD

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const ctx = document.getElementById('myChart');
    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: [{% for result in results %}'{{ result['date_realisation']|date('Y-m-d') }}',{% endfor %}],
            datasets: [{
                label: '# of Votes',
                data: [{% for result in results %}{{ result['total'] }},{% endfor %}],
                borderWidth: 1,
                backgroundColor: [
                    'rgb(255, 99, 132)',
                    'rgb(75, 192, 192)',
                    'rgb(255, 205, 86)'
                    // Ajoutez d'autres couleurs d'arrière-plan au besoin
                ]
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
=======
<script>
$(document).ready(function() {
    // Interceptez le formulaire de filtrage
    $('form').submit(function(event) {
        event.preventDefault(); // Empêche la soumission normale du formulaire
        var formData = $(this).serialize(); // Récupérez les données du formulaire
        $.ajax({
            type: 'GET',
            url: $(this).attr('action'),
            data: formData,
            success: function(data) {
                // Mettez à jour la page avec les données filtrées (par exemple, les résultats et le graphique)
                // Vous devrez implémenter cette mise à jour en fonction de votre logique spécifique.
                 updateOperations(data);
>>>>>>> 19aa47bc776bd5f491de70c2767df2a188d520a5
            }
        }
    });
<<<<<<< HEAD
</script>

{% endblock %}
=======
     function updateOperations(data) {
        var ul = $('#operation-list');
        ul.empty();
        $.each(data.filtered_operations, function(index, item) {
            var li = $('<li>').text('Date : ' + item.date_realisation + ', chiffre d\'affaire : ' + item.total + ' €');
            ul.append(li);
        });
    }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
{% endblock %}
>>>>>>> 19aa47bc776bd5f491de70c2767df2a188d520a5
